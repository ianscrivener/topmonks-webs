{% extends 'layouts/master.html' %}
{% from 'macros/helpers.html' import sprite %}

{% block title %}Hlídač shopů{% endblock %}

{% block preload %}
<link rel="prefetch" href="https://cdn.jsdelivr.net/npm/chart.js@2.9.1/dist/Chart.bundle.min.js" as="script" crossorigin="anonymous">
<link rel="modulepreload" href="https://unpkg.com/lit-html@1.1.1/lit-html.js?module" crossorigin="anonymous">
{% endblock %}

{% block main %}
<section class="main">
  <div class="mdc-layout-grid">
    <div class="mdc-layout-grid__inner layout-wrapper">
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-8-tablet mdc-layout-grid__cell--span-6-desktop">
        <h1>Ujistěte se, že nakupujete opravdu se slevou</h1>
        <form id="compare-form" action="/">
          <p>Není sleva jako sleva. Někdy obchody těsně před vlnou slev uměle
            navyšují původní ceny, aby konečná sleva působila výhodně. Hlídač
            Shopů vám zobrazí původní cenu produktu a její vývoj v&nbsp;čase, takže
            díky němu snadno poznáte, jestli nakupujete se slevou nebo&nbsp;ne.</p>

          <label class="url-input">
            <div class="url-input__icon">
              <svg width="29" height="29" viewBox="0 0 29 29" fill="none" xmlns="http://www.w3.org/2000/svg">
                <title>Hledat</title>
                <path
                  d="M24.7144 22.1558L20.6248 18.067C20.4403 17.8824 20.1901 17.7799 19.9275 17.7799H19.2589C20.391 16.3322 21.0637 14.5113 21.0637 12.5304C21.0637 7.81818 17.2449 4 12.5319 4C7.81883 4 4 7.81818 4 12.5304C4 17.2427 7.81883 21.0608 12.5319 21.0608C14.5131 21.0608 16.3343 20.3882 17.7823 19.2563V19.9248C17.7823 20.1873 17.8848 20.4375 18.0694 20.622L22.1589 24.7109C22.5445 25.0964 23.168 25.0964 23.5495 24.7109L24.7103 23.5502C25.0959 23.1647 25.0959 22.5414 24.7144 22.1558ZM12.5319 17.7799C9.63186 17.7799 7.28149 15.434 7.28149 12.5304C7.28149 9.6309 9.62776 7.28093 12.5319 7.28093C15.4319 7.28093 17.7823 9.62679 17.7823 12.5304C17.7823 15.4299 15.436 17.7799 12.5319 17.7799Z"
                  fill="#CFD4DE"/>
              </svg>
            </div>
            <input required type="url" name="url"
                   placeholder="Zadejte odkaz produktu&hellip;"
                   title="Zadejte adresu stránky s detailem produktu.">
          </label>
          <button type="submit">OVĚŘIT VÝVOJ CENY</button>
        </form>
      </div>
      <div class="example mdc-layout-grid__cell mdc-layout-grid__cell--span-8-tablet mdc-layout-grid__cell--span-6-desktop">
        <picture>
          <source media="screen and (max-width: 479px)"
                  srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_380/v1572527403/www.hlidacshopu.cz/porovnani-cen-mobile.png 1x,
                          https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_380/v1572527403/www.hlidacshopu.cz/porovnani-cen-mobile.png 1.5x,
                          https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_380/v1572527403/www.hlidacshopu.cz/porovnani-cen-mobile.png 2x">
          <source media="screen and (min-width: 480px) and (max-width: 839px)"
                  srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_740/v1572527403/www.hlidacshopu.cz/porovnani-cen-mobile.png 1x,
                          https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_740/v1572527403/www.hlidacshopu.cz/porovnani-cen-mobile.png 1.5x,
                          https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_740/v1572527403/www.hlidacshopu.cz/porovnani-cen-mobile.png 2x">
          <source media="screen and (min-width: 840px)"
                  srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_500/v1572499143/www.hlidacshopu.cz/porovnani-cen.png 1x,
                          https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_500/v1572499143/www.hlidacshopu.cz/porovnani-cen.png 1.5x,
                          https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_500/v1572499143/www.hlidacshopu.cz/porovnani-cen.png 2x">
          <img alt="Hlídač Shopů - Ukázka"
               src="https://res.cloudinary.com/topmonks/image/upload/dpr_auto,q_auto,f_auto,w_auto/v1572499143/www.hlidacshopu.cz/porovnani-cen.png"
               width="100%">
        </picture>
      </div>
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
        <h2 class="sub-title">AKTUÁLNĚ MONITORUJEME TYTO ESHOPY</h2>
        <div class="logos mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
          <a href="https://www.alza.cz/">{{sprite('alza_logo', 'Alza')}}</a>
          <a href="https://www.czc.cz/">{{sprite('czc.cz_logo', 'CZC')}}</a>
          <a href="https://www.datart.cz/">{{sprite('datart_logo', 'Datart')}}</a>
          <a href="https://www.itesco.cz/">{{sprite('tesco_logo', 'iTesco')}}</a>
          <a href="https://www.kasa.cz/">{{sprite('kasa_logo', 'kasa.cz')}}</a>
          <a href="https://www.kosik.cz/">{{sprite('kosik_logo', 'Košík.cz')}}</a>
          <a href="https://www.lekarna.cz/">{{sprite('lekarna_logo', 'Lékárna.cz')}}</a>
          <a href="https://www.mall.cz/">{{sprite('mall_logo', 'Mall.cz')}}</a>
          <a href="https://www.mironet.cz/">{{sprite('mironet_logo', 'Mironet')}}</a>
          <a href="https://www.mountfield.cz/">{{sprite('mountfield_logo', 'Mountfield')}}</a>
          <a href="https://www.notino.cz/">{{sprite('notino_logo', 'Notino')}}</a>
          <a href="https://www.rohlik.cz/">{{sprite('rohlik_logo', 'Rohlík.cz')}}</a>
          <a href="https://www.tsbohemia.cz/">{{sprite('tsbohemia_logo', 'TSBohemia')}}</a>
        </div>
      </div>
    </div>
  </div>
</section>
<section class="attendant">
  <div class="mdc-layout-grid">
    <div class="mdc-layout-grid__inner layout-wrapper">
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-8-tablet mdc-layout-grid__cell--span-12">
        <h2 class="sub-title">HLÍDAČ SHOPŮ VÁM PŘINÁŠÍ</h2>
        <div class="logos">
          <a href="https://apify.com/"><img src="/assets/img/logos/apify_logo.svg" alt="Apify" height="40"></a>
          <a href="https://www.keboola.com/"><img src="/assets/img/logos/keboola_logo.svg" alt="Keboola" height="40"></a>
          <a href="https://www.topmonks.cz/"><img src="/assets/img/logos/topmonks_logo.svg" alt="TopMonks" height="40"></a>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="illustration">
  <div class="mdc-layout-grid">
    <div class="mdc-layout-grid__inner layout-wrapper">
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
        <h2>Jak Hlídač Shopů vypadá a jak číst graf?</h2>
        <picture>
          <source media="screen and (max-width: 479px)"
                  srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_420/v1572766113/www.hlidacshopu.cz/jak-cist-graf-mobile.png 1x,
                          https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_420/v1572766113/www.hlidacshopu.cz/jak-cist-graf-mobile.png 1.5x,
                          https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_420/v1572766113/www.hlidacshopu.cz/jak-cist-graf-mobile.png 2x,">
          <source media="screen and (min-width: 480px) and (max-width: 879px)"
                  srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_740/v1572766092/www.hlidacshopu.cz/jak-cist-graf.png 1x,
                          https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_740/v1572766092/www.hlidacshopu.cz/jak-cist-graf.png 1.5x,
                          https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_740/v1572766092/www.hlidacshopu.cz/jak-cist-graf.png 2x">
          <source media="screen and (min-width: 840px)"
                  srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_1008/v1572766092/www.hlidacshopu.cz/jak-cist-graf.png 1x,
                          https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_1008/v1572766092/www.hlidacshopu.cz/jak-cist-graf.png 1.5x,
                          https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_1008/v1572766092/www.hlidacshopu.cz/jak-cist-graf.png 2x">
          <img loading="lazy"
               alt="Jak Hlídač Shopů vypadá a jak číst graf?"
               src="https://res.cloudinary.com/topmonks/image/upload/dpr_auto,q_auto,f_auto,w_auto/v1572766092/www.hlidacshopu.cz/jak-cist-graf.png"
               width="100%">
        </picture>
        <p>Hlídač Shopů si můžete <b>nainstalovat přímo do svého prohlížeče</b> a
          hlídat tak největší e-shopy a jejich někdy prapodivné taktiky při
          tvoření&nbsp;slev.</p>
      </div>
    </div>
  </div>
</section>

<section class="guidance purple-gradient">
  <div class="mdc-layout-grid">
    <div class="mdc-layout-grid__inner layout-wrapper">
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
        <h2>Jak a proč nainstalovat rozšíření Hlídač Shopů?</h2>
      </div>
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12 browser-list">
        <div class="browser-support">
          <div class="browser-support__icon">
            <img loading="lazy" src="/assets/img/chrome.svg" alt="Barevná ikona prohlížeče Google Chrome"></div>
          <p class="sub-info--grey">Podporujeme<br>prohlížeč Google&nbsp;Chrome</p>
        </div>
        <div class="browser-support">
          <div class="browser-support__icon browser-support__icon--disabled">
            <img loading="lazy" src="/assets/img/firefox.svg" alt="Barevná ikona prohlížeče Firefox"></div>
          <p class="sub-info--grey">Brzy podpora pro<br>prohlížeč Firefox</p>
        </div>
        <div class="browser-support">
          <div class="browser-support__icon browser-support__icon--disabled">
            <img loading="lazy" src="/assets/img/brave.svg" alt="Šedá ikona prohlížeče Brave"></div>
          <p class="sub-info--grey">Brzy podpora pro<br>prohlížeč Brave</p>
        </div>
        <div class="browser-support">
          <div class="browser-support__icon browser-support__icon--disabled">
            <img src="/assets/img/edge.svg" alt="Šedá ikona prohlížeče Microsoft Edge"></div>
          <p class="sub-info--grey">Brzy podpora pro<br>prohlížeč Microsoft&nbsp;Edge</p>
        </div>
      </div>
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-6-desktop">
        <h3>Instalace Hlídače Shopů do prohlížeče</h3>
        <p>Aktuálně si můžete Hlídače Shopů nainstalovat pouze do Chromu a
          Firefoxu. Pokud Chrome a Firefox nepoužíváte, vydržte. Usilovně makáme na
          verzích rozšíření Hlídače Shopů i&nbsp;pro další prohlížeče.</p>
      </div>
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-6-desktop">
        <h3>Proč byste si měli rozšíření Hlídače Shopů instalovat a jak to vlastně vypadá?</h3>
        <p>Rozšíření v&nbsp;prohlížeči vám umožňuje kontrolovat ceny rovnou na
          stránkách e-shopů. Nemusíte se pracně vracet na tento web s&nbsp;odkazem
          každého produktu, který chcete překontrolovat.</p>
      </div>
      <div class="steps mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
        <h3>Instalace probíhá ve třech jednoduchých krocích</h3>
      </div>

      <div class="step_1 mdc-layout-grid__cell mdc-layout-grid__cell--span-8-tablet">
        <picture>
          <source media="screen and (max-width: 479px)"
                  srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_380/v1572715107/www.hlidacshopu.cz/search.png 1x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_380/v1572715107/www.hlidacshopu.cz/search.png 1.5x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_380/v1572715107/www.hlidacshopu.cz/search.png 2x">
          <source media="screen and (min-width: 480px) and (max-width: 839px)"
                  srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_740/v1572715107/www.hlidacshopu.cz/search.png 1x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_740/v1572715107/www.hlidacshopu.cz/search.png 1.5x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_740/v1572715107/www.hlidacshopu.cz/search.png 2x">
          <source media="screen and (min-width: 840px)"
                  srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_340/v1572715107/www.hlidacshopu.cz/search.png 1x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_340/v1572715107/www.hlidacshopu.cz/search.png 1.5x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_340/v1572715107/www.hlidacshopu.cz/search.png 2x">
          <img loading="lazy"
               src="https://res.cloudinary.com/topmonks/image/upload/dpr_auto,q_auto,f_auto,w_auto/v1572715107/www.hlidacshopu.cz/search.png"
               alt="Najít Rozšíření - Obrázkový Průvodce"
               width="100%">
        </picture>
        <h3>Najděte rozšíření v&nbsp;obchodě</h3>
        <p class="grey-text">Přejděte do <a href="https://chrome.google.com/webstore/detail/hl%C3%ADda%C4%8D-shop%C5%AF/plmlonggbfebcjelncogcnclagkmkikk" class="text--purple">obchodu Chrome</a> na stránku Hlídače Shopů.</p>
      </div>
      <div class="step_2 mdc-layout-grid__cell mdc-layout-grid__cell--span-8-tablet">
        <picture>
          <source media="screen and (max-width: 479px)"
                  srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_380/v1572515567/www.hlidacshopu.cz/install.png 1x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_380/v1572515567/www.hlidacshopu.cz/install.png 1.5x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_380/v1572515567/www.hlidacshopu.cz/install.png 2x">
          <source media="screen and (min-width: 480px) and (max-width: 839px)"
                  srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_740/v1572515567/www.hlidacshopu.cz/install.png 1x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_740/v1572515567/www.hlidacshopu.cz/install.png 1.5x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_740/v1572515567/www.hlidacshopu.cz/install.png 2x">
          <source media="screen and (min-width: 840px)"
                  srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_340/v1572515567/www.hlidacshopu.cz/install.png 1x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_340/v1572515567/www.hlidacshopu.cz/install.png 1.5x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_340/v1572515567/www.hlidacshopu.cz/install.png 2x">
          <img loading="lazy"
               src="https://res.cloudinary.com/topmonks/image/upload/dpr_auto,q_auto,f_auto,w_auto/v1572515567/www.hlidacshopu.cz/install.png"
               alt="Instalovat Rozšíření - Obrázkový Průvodce"
               width="100%">
        </picture>
        <h3>Přidejte si rozšíření do prohlížeče</h3>
        <p class="grey-text">Vpravo nahoře klikněte na tlačítko Přidat do Chromu</p>
      </div>
      <div class="step_3 mdc-layout-grid__cell mdc-layout-grid__cell--span-8-tablet">
        <picture>
          <source media="screen and (max-width: 479px)"
                  srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_380/v1572715107/www.hlidacshopu.cz/usage.png 1x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_380/v1572715107/www.hlidacshopu.cz/usage.png 1.5x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_380/v1572715107/www.hlidacshopu.cz/usage.png 2x">
          <source media="screen and (min-width: 480px) and (max-width: 839px)"
                  srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_740/v1572715107/www.hlidacshopu.cz/usage.png 1x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_740/v1572715107/www.hlidacshopu.cz/usage.png 1.5x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_740/v1572715107/www.hlidacshopu.cz/usage.png 2x">
          <source media="screen and (min-width: 840px)"
                  srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_340/v1572715107/www.hlidacshopu.cz/usage.png1x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_340/v1572715107/www.hlidacshopu.cz/usage.png 1.5x,
                    https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_340/v1572715107/www.hlidacshopu.cz/usage.png 2x">
          <img loading="lazy"
               src="https://res.cloudinary.com/topmonks/image/upload/dpr_auto,q_auto,f_auto,w_auto/v1572715107/www.hlidacshopu.cz/usage.png"
               alt="Použití Rozšíření - Obrázkový Průvodce"
               width="100%">
        </picture>
        <h3>Potvrďte instalaci rozšíření</h3>
        <p class="grey-text">Poté na vás vyskočí okno, kde potvrdíte přidání do Chromu tlačítkem Přidat rozšíření.</p>
      </div>
      <div class="final-step mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
        <p><b>A&nbsp;máte hotovo! Skvěle.</b><br>
          Teď už jen stačí přejít do vašeho oblíbeného e-shopu a vesele kontrolovat jeho cenotvorbu.
        </p>
        <div class="btn">
          <a class="button" role="button" href="https://chrome.google.com/webstore/detail/hl%C3%ADda%C4%8D-shop%C5%AF/plmlonggbfebcjelncogcnclagkmkikk">Nainstalovat do prohlížeče</a>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="numbers">
  <div class="mdc-layout-grid">
    <div class="mdc-layout-grid__inner layout-wrapper">
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
        <h2>Naše čísla</h2>
      </div>
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-8-tablet">
        <p class="text--grey">Počet stažení</p>
        <p class="numbers">3 600+</p>
      </div>
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-8-tablet">
        <p class="text--grey">Počet e-shopů</p>
        <p class="numbers">13</p>
      </div>
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-8-tablet">
        <p class="text--grey">Počet produktů</p>
        <p class="numbers">2 000 000+</p>
      </div>
    </div>
  </div>
</section>
<section class="references">
  <div class="mdc-layout-grid">
    <div class="mdc-layout-grid__inner layout-wrapper">
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
        <h2>Co o&nbsp;nás říkají uživatelé</h2>
      </div>
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-4">
        <div class="mdc-layout-grid__inner">
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-4">
          </div>
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-8">
            <span class="text--grey">Marek Sukup</span><br>
            <span class="text--light-grey">10. 12. 2018</span>
          </div>
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
            <p>Skvělý doplněk a výborný nápad něco takového vytvořit. Človek si
              tak udelá představu o&nbsp;tom, jak funguji slevy a z&nbsp;jake ceny se
              slevuje…</p>
          </div>
        </div>
      </div>

      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-4">
        <div class="mdc-layout-grid__inner">
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-4">
          </div>
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-8">
            <span class="text--grey">Táňa Lálová</span><br>
            <span class="text--light-grey">Mluvčí Mall.cz</span>
          </div>
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
            <p>Aktivity, jako je například Apify vítáme, protože pomáhají
              zákazníkům s&nbsp;orientací na trhu. Naším cílem je být transparentní a
              umožnit lidem rychle a snadno ověřit uvedenou&nbsp;cenu.</p>
          </div>
        </div>
      </div>

      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-4">
        <div class="mdc-layout-grid__inner">
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-4">
          </div>
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-8">
            <span class="text--grey">Jan Verner</span><br>
            <span class="text--light-grey">14. 12. 2018</span>
          </div>
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
            <p>Poprvé, kdy píšu recenzi na nějaký plugin chromu. A to proto, jak je úžasný.
              Miluje ho každý, komu ho v okolí ukazuji. Super práce, samozřejmě by bylo super,
              kdyby to hlídalo více e-shopů, klidně napsat API tak, aby mohli lidé pomáhat.</p>
          </div>
        </div>
      </div>
      <!--div class="references_link mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
        <a href="/recenze/">Další hodnocení nalezente zde</a>
      </div-->
    </div>
  </div>
</section>

<section class="news mdc-layout-grid">
  <div class="mdc-layout-grid__inner layout-wrapper">
    <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
      <h2>Nejzajímavější slevy</h2>
      <picture>
        <source media="screen and (max-width: 479px)"
                srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_420/v1572499143/www.hlidacshopu.cz/mall-black-friday.png 1x,
                        https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_420/v1572499143/www.hlidacshopu.cz/mall-black-friday.png 1.5x,
                        https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_420/v1572499143/www.hlidacshopu.cz/mall-black-friday.png 2x">
        <source media="screen and (min-width: 480px) and (max-width: 839px)"
                srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_800/v1572499143/www.hlidacshopu.cz/mall-black-friday.png 1x,
                        https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_800/v1572499143/www.hlidacshopu.cz/mall-black-friday.png 1.5x,
                        https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_800/v1572499143/www.hlidacshopu.cz/mall-black-friday.png 2x">
        <source media="screen and (min-width: 840px)"
                srcset="https://res.cloudinary.com/topmonks/image/upload/dpr_1,q_auto,f_auto,w_1008/v1572499143/www.hlidacshopu.cz/mall-black-friday.png 1x,
                        https://res.cloudinary.com/topmonks/image/upload/dpr_1.5,q_auto,f_auto,w_1008/v1572499143/www.hlidacshopu.cz/mall-black-friday.png 1.5x,
                        https://res.cloudinary.com/topmonks/image/upload/dpr_2,q_auto,f_auto,w_1008/v1572499143/www.hlidacshopu.cz/mall-black-friday.png 2x">
        <img loading="lazy"
             alt="Obrázek nejzajímavějších slev"
             src="https://res.cloudinary.com/topmonks/image/upload/dpr_auto,q_auto,f_auto,w_auto/v1572499143/www.hlidacshopu.cz/mall-black-friday.png"
             width="100%">
      </picture>
    </div>
  </div>
</section>

<div id="hlidac-shopu-modal" class="modal modal--hidden">
  <div class="modal__inner mdc-layout-grid">
    <div class="modal__close">
      <a href="/" title="Zavřít">&times;</a>
    </div>
    <div id="hlidac-shopu-modal__placeholder"></div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.1/dist/Chart.bundle.min.js" integrity="sha256-8xsohuS5beL9mPWPwuzrAHckEZZnVE6/hNYhj6FLCzU=" crossorigin="anonymous"></script>
<script>
  const parseTime = s => {
    const d = new Date(s);
    d.setHours(0, 0, 0, 0);
    return d;
  };

  function* daysBetween(start, end) {
    const startDay = parseTime(start);
    const endDay = parseTime(end);
    for (const d = startDay; d <= endDay; d.setDate(d.getDate() + 1)) {
      yield new Date(d.getTime());
    }
  }

  function createDataset(data) {
    if (typeof data === "string") {
      data = JSON.parse(data);
    }
    const dataMap = new Map(data.map(x => [parseTime(x.d).getTime(), x]));
    let lastDay = data[0];
    const days = Array.from(daysBetween(parseTime(data[0].d), parseTime(data[data.length - 1].d)));
    const originalPrice = new Array(days.length);
    const currentPrice = new Array(days.length);
    for (let i = 0, l = days.length; i < l; i++) {
      const day  = days[i];
      const item = dataMap.get(day.getTime()) || lastDay;
      lastDay = item;
      originalPrice[i] = { x: day, y: item.o === "" ? null : parseInt(item.o) };
      currentPrice[i] = { x: day, y: item.c === "" ? null : parseInt(item.c) };
    }
    return {
      originalPrice,
      currentPrice
    };
  }

  Chart.defaults.global.defaultFontFamily = "'Montserrat', sans-serif";
  Chart.defaults.global.defaultFontSize = 16;
  Chart.plugins.register({
    afterDraw: function({chart, data}) {
      if (data.datasets.every(({data}) => data.length === 0)) {
        // No data is present
        var ctx = chart.ctx;
        var width = chart.width;
        var height = chart.height;

        ctx.save();
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.fillText("Chybí data", width / 2, height / 2);
        ctx.restore();
      }
    }
  });

  function plot(canvas, {data: prices}) {
    const min = Math.min(...prices.currentPrice.filter(p => p.y !== null).map(p => p.y));
    const max = Math.max(...prices.currentPrice.filter(p => p.y !== null).map(p => p.y));
    const ctx = canvas.getContext("2d");

    return new Chart(ctx, {
      type: "line",
      data: {
        labels: prices.currentPrice.map(p => p.x),
        datasets: [
          {
            label: "Uváděná původní cena",
            steppedLine: "after",
            borderColor: "#5C62CD",
            borderWidth: 3,
            borderJoinStyle: "round",
            borderCapStyle: "round",
            fill: "origin",
            backgroundColor: "#ffffff00",
            pointRadius: 0,
            spanGaps: true,
            data: prices.originalPrice,
          },
          {
            label: "Prodejní cena",
            steppedLine: "after",
            borderColor: "#FF8787",
            borderWidth: 3,
            borderJoinStyle: "round",
            borderCapStyle: "round",
            fill: "origin",
            backgroundColor: "#ffffff00",
            pointRadius: 0,
            spanGaps: true,
            data: prices.currentPrice,
          }
        ]
      },
      options: {
        legend: {
          display: false,
        },
        tooltips: {
          mode: "index",
          intersect: false,
          callbacks: {
            title(item, data) {
              const date = data.labels[item[0].index];
              return date.toLocaleDateString("cs", { day: "numeric", month: "long", year: "numeric" });
            },
            label(item, _data) {
              if (item.datasetIndex === 0) {
                return `Uváděná původní cena: ${item.yLabel.toLocaleString("cs")},- Kč`;
              }
              return `Prodejní cena: ${item.yLabel.toLocaleString("cs")},- Kč`;
            },
            labelColor(item, _chart) {
              const red = "#FF8787";
              const blue = "#5C62CD";
              const color = item.datasetIndex === 1 ? red : blue;

              return {
                borderColor: color,
                backgroundColor: color,
              };
            },
          }
        },
        scales: {
          xAxes: [{
            type: "time",
            time: {
              unit: "day",
              stepSize: 14,
              displayFormats: {
                day: "D. MM. YYYY"
              }
            },
          }],
          yAxes: [{
            ticks: {
              suggestedMax: max + 0.1 * max,
              suggestedMin: min - 0.1 * min,
            }
          }]
        }
      },
    });
  }
</script>

<script type="module" crossorigin="anonymous">
  import {html, render} from "https://unpkg.com/lit-html@1.1.1/lit-html.js?module";
  const form = document.getElementById("compare-form");
  const modal = document.getElementById("hlidac-shopu-modal");
  const modalRenderRoot = document.getElementById("hlidac-shopu-modal__placeholder");
  const chart = () => document.getElementById("hlidac-shopu-chart");
  const apiUrl = detailUri => `https://api.hlidacshopu.cz/shop?url=${encodeURIComponent(detailUri)}&metadata=1`;
  const meta = ({itemImage, itemName}) => ({name: itemName, imageUrl: itemImage === "null" ? null : itemImage});
  const formatMoney = x => x.toLocaleString("cs", {minimumFractionDigits: 2, maximumFractionDigits: 2}).replace(/,00/g, ",-");
  const formatPercents = x => `${Math.round(100 * x).toLocaleString("cs")} %`;
  const haveToCloseModal = t => t === modal || t.classList.contains("modal__close") || t.parentElement.classList.contains("modal__close");
  const timeout = ms => new Promise((_, reject) => setTimeout(() => reject(new Error("timeout")), ms));

  form.addEventListener("submit", e => {
    e.preventDefault();
    const detailUri = e.target["url"].value;
    history.pushState({showModal: true, detailUri}, null, `?url=${encodeURIComponent(detailUri)}`);
    renderResultsModal(detailUri);
  });

  modal.addEventListener("click", e => {
    e.preventDefault();
    const target = e.target;
    if (haveToCloseModal(target)) {
      history.pushState({showModal: false}, null, "/");
      hideResultsModal();
    }
  });

  addEventListener("load", e => {
    const searchParams = new URLSearchParams(location.search);
    if (searchParams.has("url")) {
      renderResultsModal(searchParams.get("url"));
    }
  });

  addEventListener("popstate", e => {
    if (!history.state) {
      hideResultsModal();
      return;
    }
    const {showModal, detailUri} = history.state;
    if (showModal) {
      renderResultsModal(detailUri);
    }
    else {
      hideResultsModal();
    }
  });

  function showResultsModal() {
    modal.classList.remove("modal--hidden");
    document.body.classList.add("no-scroll");
  }

  function hideResultsModal() {
    modal.classList.add("modal--hidden");
    document.body.classList.remove("no-scroll");
  }

  async function fetchDataSet(detailUri) {
    const resp = await Promise.race([timeout(4000), fetch(apiUrl(detailUri))]);
    if (!resp.ok) throw new Error("API error");
    const {data, metadata} = await resp.json();
    return {
      meta: meta(metadata),
      data: createDataset(data)
    };
  }

  function templateData(detailUrl, { meta: { name, imageUrl }, data: { currentPrice, originalPrice } }) {
    const lastActualPrice = currentPrice.filter(({ y }) => y).pop();
    const lastClaimedPrice = originalPrice.map(x => x.y).filter(y => y).pop();
    const actualPrice = lastActualPrice.y;
    const date = lastActualPrice.x;
    const origPrice = currentPrice.map(x => x.y).filter(y => y)[0];
    const discount = (origPrice - actualPrice) / origPrice;
    return { detailUrl, name, imageUrl, discount, actualPrice, date, lastClaimedPrice };
  }

  async function renderResultsModal(detailUrl) {
    render(loaderTemplate(), modalRenderRoot);
    showResultsModal();
    try {
      const chartData = await fetchDataSet(detailUrl);
      render(resultTemplate(templateData(detailUrl, chartData)), modalRenderRoot);
      plot(chart(), chartData);
    }
    catch (ex) {
      console.error(ex);
      render(notFoundTemplate(), modalRenderRoot);
    }
  }

  function notFoundTemplate() {
    return html`
      <div id="hlidac-shopu-modal__not-found" class="result mdc-layout-grid__inner">
        <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
          <h2>Nenalezeno</h2>
        </div>
        <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12 box box--purple">
          <p>Je nám líto, ale hledaný produkt nebo e-shop nemáme v naší databázi.</p>
        </div>
      </div>
    `;
  }

  function loaderTemplate() {
    return html`
      <div id="hlidac-shopu-modal__loader" class="result mdc-layout-grid__inner">
        <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
          <h2>Ověřuji&hellip;</h2>
        </div>
        <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12 box box--purple">
          <div class=loading-container>
            <div class=loader aria-label="Načítám data…">Váš požadavek se zpracovává&hellip;</div>
          </div>
        </div>
      </div>
    `;
  }

  function resultTemplate({detailUrl, name, imageUrl, lastClaimedPrice, actualPrice, discount, date}) {
    const claimedPrice = x => x && html`<div class="claimed-price">Uváděná původní cena <del id="original-price">${formatMoney(x)}</del></div>`;
    const realDiscount = x => x && html`<div>Reálná sleva <b class="discount"><span id="real-discount">${formatPercents(x)}</span></b></div>`;
    const crawlDate = x => x && html`<time id="latest-date" datetime="${x.toISOString()}">${x.toLocaleString("cs", {day: "numeric", month: "long", year: "numeric"})}</time>`;
    return html`
      <div id="hlidac-shopu-modal__found" class="result mdc-layout-grid__inner">
        <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
          <h2><a href="${detailUrl}" id="product-name">${name}</a></h2>
        </div>
        <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12 box box--purple">
          ${crawlDate(date)}
          ${claimedPrice(lastClaimedPrice)}
          <div class="actual-price">Prodejní cena <span id="current-price">${formatMoney(actualPrice)}</span></div>
          ${realDiscount(discount)}
        </div>
        <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
          <canvas id="hlidac-shopu-chart" width="100%"></canvas>
        </div>
        <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
          <div style="display:flex;justify-content: flex-end">
            <div style="width:12px;height:12px;background-color:#5C62CD;border-radius:2px;margin-right:5px;margin-top:2px;"></div>
            <span>Uváděná původní cena</span>
            <div style="width:12px;height:12px;background-color:#FF8787;border-radius:2px;margin: 2px 5px 0 8px;"></div>
            <span>Prodejní cena</span>
          </div>
        </div>
      </div>
    `;
  }
</script>
{% endblock %}
